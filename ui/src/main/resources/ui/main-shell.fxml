<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>

<BorderPane fx:id="root" prefWidth="1200" prefHeight="800" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.todo.desktop.ui.controller.MainShellController" 
            style="-fx-background-color: -fx-bg-app;"
            stylesheets="@styles.css">
    <fx:define>
        <ToggleGroup fx:id="mainNavGroup"/>
    </fx:define>

    <!-- LEFT SIDEBAR -->
    <left>
        <VBox prefWidth="260" styleClass="sidebar" spacing="0">
            <padding>
                <Insets top="24" right="16" bottom="24" left="16"/>
            </padding>

            <!-- Brand Area -->
            <HBox alignment="CENTER_LEFT" spacing="12">
                <padding>
                    <Insets bottom="32" left="12"/>
                </padding>
                <StackPane style="-fx-background-color: -fx-primary; -fx-background-radius: 8; -fx-padding: 8;">
                    <Label text="TD" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 16px;"/>
                </StackPane>
                <Label text="To-Do App" styleClass="header-medium"/>
            </HBox>

            <!-- Navigation Items -->
            <VBox spacing="4" VBox.vgrow="ALWAYS">
                <ToggleButton fx:id="emailToggle" text="Há»™p thÆ° Ä‘áº¿n" toggleGroup="$mainNavGroup" onAction="#showEmail" styleClass="nav-button" maxWidth="Infinity" selected="true">
                    <graphic>
                        <Label text="ðŸ“¨" style="-fx-font-size: 16px; -fx-padding: 0 8 0 0;"/>
                    </graphic>
                </ToggleButton>
                
                <ToggleButton fx:id="deadlineToggle" text="CÃ´ng viá»‡c &amp; Deadline" toggleGroup="$mainNavGroup" onAction="#showDeadline" styleClass="nav-button" maxWidth="Infinity">
                    <graphic>
                        <Label text="ðŸ“…" style="-fx-font-size: 16px; -fx-padding: 0 8 0 0;"/>
                    </graphic>
                </ToggleButton>
                
                <Region VBox.vgrow="ALWAYS" /> <!-- Spacer -->
                
                <ToggleButton fx:id="settingsToggle" text="CÃ i Ä‘áº·t" toggleGroup="$mainNavGroup" onAction="#showSettings" styleClass="nav-button" maxWidth="Infinity">
                    <graphic>
                        <Label text="âš™ï¸" style="-fx-font-size: 16px; -fx-padding: 0 8 0 0;"/>
                    </graphic>
                </ToggleButton>
            </VBox>
            
            <!-- User Profile (Bottom) -->
            <VBox spacing="12">
                <padding>
                    <Insets top="24"/>
                </padding>
                <Region style="-fx-background-color: #E2E8F0; -fx-min-height: 1; -fx-max-height: 1;" />
                
                <HBox alignment="CENTER_LEFT" spacing="16">
                    <StackPane styleClass="avatar-circle" prefWidth="40" prefHeight="40">
                        <ImageView fx:id="avatarImageView" fitWidth="40" fitHeight="40" preserveRatio="true">
                             <clip>
                                <Circle radius="20" centerX="20" centerY="20" />
                             </clip>
                        </ImageView>
                        <Label fx:id="avatarFallback" text="U" styleClass="avatar-text" visible="false"/>
                    </StackPane>
                    
                    <VBox spacing="2">
                        <Label fx:id="userNameLabel" text="User Name" style="-fx-font-weight: 600; -fx-text-fill: -fx-text-main;"/>
                        <Label fx:id="userEmailLabel" text="user@example.com" styleClass="text-caption"/>
                    </VBox>
                    
                    <Region HBox.hgrow="ALWAYS"/>
                    
                    <Button fx:id="signOutButton" text="â»" onAction="#onSignOut" styleClass="button-icon">
                        <tooltip><Tooltip text="ÄÄƒng xuáº¥t"/></tooltip>
                    </Button>
                </HBox>
            </VBox>
        </VBox>
    </left>

    <!-- MAIN CONTENT -->
    <center>
        <StackPane fx:id="contentContainer" style="-fx-padding: 24;">
            <fx:include fx:id="deadlineOverview" source="deadline-overview.fxml"/>
            <fx:include fx:id="inboxView" source="inbox.fxml" visible="false" managed="false"/>
            <fx:include fx:id="emailDetailView" source="email-detail.fxml" visible="false" managed="false"/>
            <fx:include fx:id="settingsView" source="settings.fxml" visible="false" managed="false"/>
        </StackPane>
    </center>
</BorderPane>
